{
  "Components": [
    {
      "ComponentName": "LogDirectory",
      "ComponentType": "DirectoryCreate",
      "Path": "C:\\log"
    },
    {
      "ComponentName": "ToolsDirectory",
      "ComponentType": "DirectoryCreate",
      "Path": "C:\\tools"
    },
    {
      "ComponentName": "vcredist_vs2013_x86",
      "ComponentType": "ExeInstall",
      "Url": "http://download.microsoft.com/download/2/E/6/2E61CFA4-993B-4DD4-91DA-3737CD5CD6E3/vcredist_x86.exe",
      "Arguments": [
        "/install",
        "/passive",
        "/norestart",
        "/Log",
        "C:\\log\\vcredist_vs2013_x86-install.log"
      ],
      "Validate": {
        "PathsExist": [
          "C:\\Windows\\System32\\msvcr120.dll"
        ]
      }
    },
    {
      "ComponentName": "vcredist_vs2013_x64",
      "ComponentType": "ExeInstall",
      "Url": "http://download.microsoft.com/download/2/E/6/2E61CFA4-993B-4DD4-91DA-3737CD5CD6E3/vcredist_x64.exe",
      "Arguments": [
        "/install",
        "/passive",
        "/norestart",
        "/Log",
        "C:\\log\\vcredist_vs2013_x64-install.log"
      ],
      "Validate": {
        "PathsExist": [
          "C:\\Windows\\SysWOW64\\msvcr120.dll"
        ]
      }
    },
    {
      "ComponentName": "windowssdksetup",
      "ComponentType": "ExeInstall",
      "Url": "http://download.microsoft.com/download/B/0/C/B0C80BA3-8AD6-4958-810B-6882485230B5/standalonesdk/sdksetup.exe",
      "Arguments": [
        "/Quiet",
        "/NoRestart",
        "/Log",
        "C:\\log\\windowssdksetup.log"
      ]
    },
    {
      "ComponentName": "MozillaBuildSetup",
      "ComponentType": "ExeInstall",
      "Arguments": [
        "/S",
        "/D=C:\\mozilla-build"
      ],
      "Url": "http://ftp.mozilla.org/pub/mozilla/libraries/win32/MozillaBuildSetup-2.2.0.exe",
      "Validate": {
        "PathsExist": [
          "C:\\mozilla-build\\msys\\bin\\sh.exe",
          "C:\\mozilla-build\\msys\\local\\bin\\make.exe",
          "C:\\mozilla-build\\msys\\local\\bin\\autoconf-2.13",
          "C:\\mozilla-build\\info-zip\\unzip.exe",
          "C:\\mozilla-build\\info-zip\\zip.exe"
        ],
        "FilesContain": [
          {
            "Path": "C:\\mozilla-build\\VERSION",
            "Match": "2.2.0"
          }
        ]
      }
    },
    {
      "ComponentName": "MercurialConfig",
      "ComponentType": "FileDownload",
      "DependsOn": [
        {
          "ComponentType": "ExeInstall",
          "ComponentName": "MozillaBuildSetup"
        }
      ],
      "Source": "https://raw.githubusercontent.com/MozRelOps/OpenCloudConfig/master/userdata/Configuration/Mercurial/mercurial.ini",
      "Target": "C:\\mozilla-build\\python\\Scripts\\mercurial.ini"
    },
    {
      "ComponentName": "pip-upgrade-pip",
      "ComponentType": "CommandRun",
      "DependsOn": [
        {
          "ComponentType": "ExeInstall",
          "ComponentName": "MozillaBuildSetup"
        }
      ],
      "Command": "C:\\mozilla-build\\python\\python.exe",
      "Arguments": [
        "-m",
        "pip",
        "install",
        "--upgrade",
        "pip==8.1.1"
      ],
      "Validate": {
        "CommandsReturn": [
          {
            "Command": "C:\\mozilla-build\\python\\python.exe",
            "Arguments": [
              "-m",
              "pip",
              "show",
              "pip"
            ],
            "Match": "Version: 8.1.1"
          }
        ]
      }
    },
    {
      "ComponentName": "pip-upgrade-setuptools",
      "ComponentType": "CommandRun",
      "DependsOn": [
        {
          "ComponentType": "CommandRun",
          "ComponentName": "pip-upgrade-pip"
        }
      ],
      "Command": "C:\\mozilla-build\\python\\python.exe",
      "Arguments": [
        "-m",
        "pip",
        "install",
        "--upgrade",
        "setuptools==20.7.0"
      ],
      "Validate": {
        "CommandsReturn": [
          {
            "Command": "C:\\mozilla-build\\python\\python.exe",
            "Arguments": [
              "-m",
              "pip",
              "show",
              "setuptools"
            ],
            "Match": "Version: 20.7.0"
          }
        ]
      }
    },
    {
      "ComponentName": "pip-upgrade-virtualenv",
      "ComponentType": "CommandRun",
      "DependsOn": [
        {
          "ComponentType": "CommandRun",
          "ComponentName": "pip-upgrade-pip"
        }
      ],
      "Command": "C:\\mozilla-build\\python\\python.exe",
      "Arguments": [
        "-m",
        "pip",
        "install",
        "--upgrade",
        "virtualenv==15.0.1"
      ],
      "Validate": {
        "CommandsReturn": [
          {
            "Command": "C:\\mozilla-build\\python\\python.exe",
            "Arguments": [
              "-m",
              "pip",
              "show",
              "virtualenv"
            ],
            "Match": "Version: 15.0.1"
          }
        ]
      }
    },
    {
      "ComponentName": "pip-upgrade-wheel",
      "ComponentType": "CommandRun",
      "DependsOn": [
        {
          "ComponentType": "CommandRun",
          "ComponentName": "pip-upgrade-pip"
        }
      ],
      "Command": "C:\\mozilla-build\\python\\python.exe",
      "Arguments": [
        "-m",
        "pip",
        "install",
        "--upgrade",
        "wheel==0.29.0"
      ],
      "Validate": {
        "CommandsReturn": [
          {
            "Command": "C:\\mozilla-build\\python\\python.exe",
            "Arguments": [
              "-m",
              "pip",
              "show",
              "wheel"
            ],
            "Match": "Version: 0.29.0"
          }
        ]
      }
    },
    {
      "ComponentName": "pip-upgrade-pypiwin32",
      "ComponentType": "CommandRun",
      "DependsOn": [
        {
          "ComponentType": "CommandRun",
          "ComponentName": "pip-upgrade-pip"
        }
      ],
      "Command": "C:\\mozilla-build\\python\\python.exe",
      "Arguments": [
        "-m",
        "pip",
        "install",
        "--upgrade",
        "pypiwin32==219"
      ],
      "Validate": {
        "CommandsReturn": [
          {
            "Command": "C:\\mozilla-build\\python\\python.exe",
            "Arguments": [
              "-m",
              "pip",
              "show",
              "pypiwin32"
            ],
            "Match": "Version: 219"
          }
        ]
      }
    },
    {
      "ComponentName": "pip-upgrade-requests",
      "ComponentType": "CommandRun",
      "DependsOn": [
        {
          "ComponentType": "CommandRun",
          "ComponentName": "pip-upgrade-pip"
        }
      ],
      "Command": "C:\\mozilla-build\\python\\python.exe",
      "Arguments": [
        "-m",
        "pip",
        "install",
        "--upgrade",
        "requests==2.9.1"
      ],
      "Validate": {
        "CommandsReturn": [
          {
            "Command": "C:\\mozilla-build\\python\\python.exe",
            "Arguments": [
              "-m",
              "pip",
              "show",
              "requests"
            ],
            "Match": "Version: 2.9.1"
          }
        ]
      }
    },
    {
      "ComponentName": "pip-upgrade-psutil",
      "ComponentType": "CommandRun",
      "DependsOn": [
        {
          "ComponentType": "CommandRun",
          "ComponentName": "pip-upgrade-pip"
        }
      ],
      "Command": "C:\\mozilla-build\\python\\python.exe",
      "Arguments": [
        "-m",
        "pip",
        "install",
        "--upgrade",
        "psutil==4.1.0"
      ],
      "Validate": {
        "CommandsReturn": [
          {
            "Command": "C:\\mozilla-build\\python\\python.exe",
            "Arguments": [
              "-m",
              "pip",
              "show",
              "psutil"
            ],
            "Match": "Version: 4.1.0"
          }
        ]
      }
    }
  ]
}