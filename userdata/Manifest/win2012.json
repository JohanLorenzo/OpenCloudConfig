{
  "Components": [
    {
      "ComponentName": "LogDirectory",
      "ComponentType": "DirectoryCreate",
      "Comment": "Required by OpenCloudConfig for DSC logging",
      "Path": "C:\\log"
    },
    {
      "ComponentName": "NxLog",
      "ComponentType": "MsiInstall",
      "Comment": "Maintenance Toolchain - not essential for building firefox",
      "Url": "http://nxlog.org/system/files/products/files/1/nxlog-ce-2.9.1504.msi",
      "Name": "NxLog-CE",
      "ProductId": "5E1D25F5-647E-44CA-9223-387230EC02C6"
    },
    {
      "ComponentName": "PaperTrailEncryptionCertificate",
      "ComponentType": "FileDownload",
      "Comment": "Maintenance Toolchain - not essential for building firefox",
      "Source": "https://papertrailapp.com/tools/papertrail-bundle.pem",
      "Target": "C:\\Program Files (x86)\\nxlog\\cert\\papertrail-bundle.pem",
      "DependsOn": [
        {
          "ComponentType": "MsiInstall",
          "ComponentName": "NxLog"
        }
      ]
    },
    {
      "ComponentName": "NxLogPaperTrailConfiguration",
      "ComponentType": "FileDownload",
      "Comment": "Maintenance Toolchain - not essential for building firefox",
      "Source": "https://raw.githubusercontent.com/MozRelOps/OpenCloudConfig/master/userdata/Configuration/nxlog.conf",
      "Target": "C:\\Program Files (x86)\\nxlog\\conf\\nxlog.conf",
      "DependsOn": [
        {
          "ComponentType": "FileDownload",
          "ComponentName": "PaperTrailEncryptionCertificate"
        }
      ]
    },
    {
      "ComponentName": "Start-nxlog",
      "ComponentType": "ServiceControl",
      "Comment": "Maintenance Toolchain - not essential for building firefox",
      "Name": "nxlog",
      "StartupType": "Automatic",
      "State": "Running",
      "DependsOn": [
        {
          "ComponentType": "FileDownload",
          "ComponentName": "NxLogPaperTrailConfiguration"
        }
      ]
    },
    {
      "ComponentName": "GpgForWin",
      "ComponentType": "ExeInstall",
      "Comment": "Maintenance Toolchain - not essential for building firefox",
      "Url": "http://files.gpg4win.org/gpg4win-2.3.0.exe",
      "Arguments": [
        "/S"
      ],
      "Validate": {
        "PathsExist": [
          "C:\\Program Files (x86)\\GNU\\GnuPG\\pub\\gpg.exe",
          "C:\\Program Files (x86)\\GNU\\GnuPG\\pub\\gpg2.exe"
        ]
      }
    },
    {
      "ComponentName": "SevenZip",
      "ComponentType": "ExeInstall",
      "Comment": "Maintenance Toolchain - not essential for building firefox",
      "Url": "http://7-zip.org/a/7z1514-x64.exe",
      "Arguments": [
        "/S"
      ],
      "Validate": {
        "PathsExist": [
          "C:\\Program Files\\7-Zip\\7z.exe",
          "C:\\Program Files\\7-Zip\\7z.dll"
        ]
      }
    },
    {
      "ComponentName": "SublimeText3",
      "ComponentType": "ExeInstall",
      "Comment": "Maintenance Toolchain - not essential for building firefox",
      "Url": "https://download.sublimetext.com/Sublime%20Text%20Build%203114%20x64%20Setup.exe",
      "Arguments": [
        "/VERYSILENT",
        "/NORESTART",
        "/TASKS=\"contextentry\""
      ],
      "Validate": {
        "PathsExist": [
          "C:\\Program Files\\Sublime Text 3\\subl.exe",
          "C:\\Program Files\\Sublime Text 3\\sublime_text.exe"
        ]
      }
    },
    {
      "ComponentName": "SublimeText3-PackagesFolder",
      "ComponentType": "DirectoryCreate",
      "Comment": "Maintenance Toolchain - not essential for building firefox",
      "Path": "C:\\Users\\Administrator\\AppData\\Roaming\\Sublime Text 3\\Packages"
    },
    {
      "ComponentName": "SublimeText3-PackageControl",
      "ComponentType": "FileDownload",
      "Comment": "Maintenance Toolchain - not essential for building firefox",
      "Source": "http://sublime.wbond.net/Package%20Control.sublime-package",
      "Target": "C:\\Users\\Administrator\\AppData\\Roaming\\Sublime Text 3\\Packages\\Package Control.sublime-package",
      "DependsOn": [
        {
          "ComponentType": "ExeInstall",
          "ComponentName": "SublimeText3"
        },
        {
          "ComponentType": "DirectoryCreate",
          "ComponentName": "SublimeText3-PackagesFolder"
        }
      ]
    },
    {
      "ComponentName": "SystemPowerShellProfile",
      "ComponentType": "FileDownload",
      "Comment": "Maintenance Toolchain - not essential for building firefox",
      "Source": "https://raw.githubusercontent.com/MozRelOps/OpenCloudConfig/master/userdata/Configuration/Microsoft.PowerShell_profile.ps1",
      "Target": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\Microsoft.PowerShell_profile.ps1"
    },
    {
      "ComponentName": "DiskPartitionStripeConfiguration",
      "ComponentType": "FileDownload",
      "Comment": "Maintenance Toolchain - not essential for building firefox",
      "Source": "https://raw.githubusercontent.com/MozRelOps/OpenCloudConfig/master/userdata/Configuration/DiskPart/stripe-yz-x.dp",
      "Target": "C:\\Windows\\Temp\\stripe-yz-x.dp"
    },
    {
      "ComponentName": "DiskPartitionStripe",
      "ComponentType": "CommandRun",
      "Comment": "Maintenance Toolchain - not essential for building firefox",
      "Command": "diskpart.exe",
      "Arguments": [
        "/s",
        "C:\\Windows\\Temp\\stripe-yz-x.dp"
      ],
      "DependsOn": [
        {
          "ComponentType": "FileDownload",
          "ComponentName": "DiskPartitionStripeConfiguration"
        }
      ],
      "Validate": {
        "PathsExist": [
          "X:\\"
        ],
        "PathsNotExist": [
          "Y:\\",
          "Z:\\"
        ]
      }
    },
    {
      "ComponentName": "FsutilDisable8Dot3",
      "ComponentType": "CommandRun",
      "Comment": "Maintenance Toolchain - not essential for building firefox",
      "Command": "fsutil.exe",
      "Arguments": [
        "behavior",
        "set",
        "disable8dot3",
        "1"
      ],
      "Validate": {
        "CommandsReturn": [
          {
            "Command": "fsutil.exe",
            "Arguments": [
              "behavior",
              "query",
              "disable8dot3"
            ],
            "Match": "The registry state is: 1 (Disable 8dot3 name creation on all volumes)."
          }
        ]
      }
    },
    {
      "ComponentName": "FsutilDisableLastAccess",
      "ComponentType": "CommandRun",
      "Comment": "Maintenance Toolchain - not essential for building firefox",
      "Command": "fsutil.exe",
      "Arguments": [
        "behavior",
        "set",
        "disablelastaccess",
        "1"
      ],
      "Validate": {
        "CommandsReturn": [
          {
            "Command": "fsutil.exe",
            "Arguments": [
              "behavior",
              "query",
              "disablelastaccess"
            ],
            "Match": "DisableLastAccess = 1"
          }
        ]
      }
    },
    {
      "ComponentName": "Home",
      "ComponentType": "SymbolicLink",
      "Comment": "Maintenance Toolchain - not essential for building firefox",
      "Target": "C:\\Users",
      "Link": "C:\\home"
    },
    {
      "ComponentName": "Start-wuauserv",
      "ComponentType": "ServiceControl",
      "Comment": "Required by NET-Framework-Core",
      "Name": "wuauserv",
      "StartupType": "Manual",
      "State": "Running"
    },
    {
      "ComponentName": "NET-Framework-Core",
      "ComponentType": "WindowsFeatureInstall",
      "Comment": "Required by DXSDK_Jun10",
      "Name": "NET-Framework-Core",
      "DependsOn": [
        {
          "ComponentType": "ServiceControl",
          "ComponentName": "Start-wuauserv"
        }
      ]
    },
    {
      "ComponentName": "VisualC2010RedistributablePackageX86Uninstall",
      "ComponentType": "CommandRun",
      "Comment": "Required by DXSDK_Jun10 (https://blogs.msdn.microsoft.com/chuckw/2011/12/09/known-issue-directx-sdk-june-2010-setup-and-the-s1023-error)",
      "Command": "msiexec.exe",
      "Arguments": [
        "/passive",
        "/uninstall",
        "{F0C3E5D1-1ADE-321E-8167-68EF0DE699A5}"
      ],
      "Validate": {
        "PathsNotExist": [
          "C:\\Windows\\System32\\msvcr100.dll"
        ]
      }
    },
    {
      "ComponentName": "VisualC2010RedistributablePackageX86_64Uninstall",
      "ComponentType": "CommandRun",
      "Comment": "Required by DXSDK_Jun10 (https://blogs.msdn.microsoft.com/chuckw/2011/12/09/known-issue-directx-sdk-june-2010-setup-and-the-s1023-error)",
      "Command": "msiexec.exe",
      "Arguments": [
        "/passive",
        "/uninstall",
        "{1D8E6291-B0D5-35EC-8441-6616F567A0F7}"
      ],
      "Validate": {
        "PathsNotExist": [
          "C:\\Windows\\SysWOW64\\msvcr100.dll"
        ]
      }
    },
    {
      "ComponentName": "DXSDK_Jun10",
      "ComponentType": "ExeInstall",
      "Comment": "Provides D3D compilers required by 32 bit builds",
      "Url": "http://download.microsoft.com/download/A/E/7/AE743F1F-632B-4809-87A9-AA1BB3458E31/DXSDK_Jun10.exe",
      "Arguments": [
        "/U"
      ],
      "DependsOn": [
        {
          "ComponentType": "WindowsFeatureInstall",
          "ComponentName": "NET-Framework-Core"
        },
        {
          "ComponentType": "CommandRun",
          "ComponentName": "VisualC2010RedistributablePackageX86Uninstall"
        },
        {
          "ComponentType": "CommandRun",
          "ComponentName": "VisualC2010RedistributablePackageX86_64Uninstall"
        }
      ],
      "Validate": {
        "PathsExist": [
          "C:\\Program Files (x86)\\Microsoft DirectX SDK (June 2010)\\system\\uninstall\\DXSDK_Jun10.exe",
          "C:\\Program Files (x86)\\Microsoft DirectX SDK (June 2010)\\Lib\\x86\\*.lib",
          "C:\\Program Files (x86)\\Microsoft DirectX SDK (June 2010)\\Lib\\x64\\*.lib",
          "C:\\Program Files (x86)\\Microsoft DirectX SDK (June 2010)\\Include\\*.h"
        ]
      }
    },
    {
      "ComponentName": "vcredist_vs2010_x86",
      "ComponentType": "ExeInstall",
      "Comment": "Required by yasm (c:/mozilla-build/yasm/yasm.exe)",
      "Url": "http://download.microsoft.com/download/C/6/D/C6D0FD4E-9E53-4897-9B91-836EBA2AACD3/vcredist_x86.exe",
      "Arguments": [
        "/install",
        "/passive",
        "/norestart",
        "/log",
        "C:\\log\\vcredist_vs2010_x86-install.log"
      ],
      "DependsOn": [
        {
          "ComponentType": "ExeInstall",
          "ComponentName": "DXSDK_Jun10"
        }
      ],
      "Validate": {
        "PathsExist": [
          "C:\\Windows\\SysWOW64\\msvcr100.dll"
        ]
      }
    },
    {
      "ComponentName": "vcredist_vs2010_x64",
      "ComponentType": "ExeInstall",
      "Comment": "Required by yasm (c:/mozilla-build/yasm/yasm.exe)",
      "Url": "http://download.microsoft.com/download/A/8/0/A80747C3-41BD-45DF-B505-E9710D2744E0/vcredist_x64.exe",
      "Arguments": [
        "/install",
        "/passive",
        "/norestart",
        "/log",
        "C:\\log\\vcredist_vs2010_x64-install.log"
      ],
      "DependsOn": [
        {
          "ComponentType": "ExeInstall",
          "ComponentName": "DXSDK_Jun10"
        }
      ],
      "Validate": {
        "PathsExist": [
          "C:\\Windows\\System32\\msvcr100.dll"
        ]
      }
    },
    {
      "ComponentName": "vcredist_vs2013_x86",
      "ComponentType": "ExeInstall",
      "Comment": "Required by rustc (tooltool artefact)",
      "Url": "http://download.microsoft.com/download/2/E/6/2E61CFA4-993B-4DD4-91DA-3737CD5CD6E3/vcredist_x86.exe",
      "Arguments": [
        "/install",
        "/passive",
        "/norestart",
        "/log",
        "C:\\log\\vcredist_vs2013_x86-install.log"
      ],
      "Validate": {
        "PathsExist": [
          "C:\\Windows\\SysWOW64\\msvcr120.dll"
        ]
      }
    },
    {
      "ComponentName": "vcredist_vs2013_x64",
      "ComponentType": "ExeInstall",
      "Comment": "Required by rustc (tooltool artefact)",
      "Url": "http://download.microsoft.com/download/2/E/6/2E61CFA4-993B-4DD4-91DA-3737CD5CD6E3/vcredist_x64.exe",
      "Arguments": [
        "/install",
        "/passive",
        "/norestart",
        "/log",
        "C:\\log\\vcredist_vs2013_x64-install.log"
      ],
      "Validate": {
        "PathsExist": [
          "C:\\Windows\\System32\\msvcr120.dll"
        ]
      }
    },
    {
      "ComponentName": "vcredist_vs2015_x86",
      "ComponentType": "ExeInstall",
      "Comment": "Required by rustc (tooltool artefact)",
      "Url": "http://download.microsoft.com/download/f/3/9/f39b30ec-f8ef-4ba3-8cb4-e301fcf0e0aa/vc_redist.x86.exe",
      "Arguments": [
        "/install",
        "/passive",
        "/norestart",
        "/log",
        "C:\\log\\vcredist_vs2015_x86-install.log"
      ],
      "Validate": {
        "PathsExist": [
          "C:\\Windows\\SysWOW64\\vcruntime140.dll"
        ]
      }
    },
    {
      "ComponentName": "vcredist_vs2015_x64",
      "ComponentType": "ExeInstall",
      "Comment": "Required by rustc (tooltool artefact)",
      "Url": "http://download.microsoft.com/download/4/c/b/4cbd5757-0dd4-43a7-bac0-2a492cedbacb/vc_redist.x64.exe",
      "Arguments": [
        "/install",
        "/passive",
        "/norestart",
        "/log",
        "C:\\log\\vcredist_vs2015_x64-install.log"
      ],
      "Validate": {
        "PathsExist": [
          "C:\\Windows\\System32\\vcruntime140.dll"
        ]
      }
    },
    {
      "ComponentName": "windowssdksetup",
      "ComponentType": "ExeInstall",
      "Url": "http://download.microsoft.com/download/B/0/C/B0C80BA3-8AD6-4958-810B-6882485230B5/standalonesdk/sdksetup.exe",
      "Arguments": [
        "/Quiet",
        "/NoRestart",
        "/Log",
        "C:\\log\\windowssdksetup.log"
      ]
    },
    {
      "ComponentName": "PdbStrPathHack",
      "ComponentType": "SymbolicLink",
      "Comment": "Required because of in-tree paths: https://dxr.mozilla.org/mozilla-central/search?q=%2Fc%2FProgram+Files+(x86)%2FWindows+Kits%2F8.0%2FDebuggers%2Fx64%2Fsrcsrv%2Fpdbstr.exe&redirect=false",
      "DependsOn": [
        {
          "ComponentType": "ExeInstall",
          "ComponentName": "windowssdksetup"
        }
      ],
      "Target": "C:\\Program Files (x86)\\Windows Kits\\8.1",
      "Link": "C:\\Program Files (x86)\\Windows Kits\\8.0"
    },
    {
      "ComponentName": "VisualStudio2015AdminDeployment",
      "ComponentType": "FileDownload",
      "Source": "https://raw.githubusercontent.com/MozRelOps/OpenCloudConfig/master/userdata/Configuration/VisualStudio2015/AdminDeployment.xml",
      "Target": "C:\\Windows\\Temp\\VisualStudio2015AdminDeployment.xml"
    },
    {
      "ComponentName": "VisualStudio2015Community",
      "ComponentType": "ExeInstall",
      "Url": "http://download.microsoft.com/download/0/B/C/0BC321A4-013F-479C-84E6-4A2F90B11269/vs_community.exe",
      "Arguments": [
        "/Passive",
        "/NoRestart",
        "/AdminFile",
        "C:\\Windows\\Temp\\VisualStudio2015AdminDeployment.xml",
        "/Log",
        "C:\\log\\VisualStudio2015CommunityInstall.log"
      ],
      "DependsOn": [
        {
          "ComponentType": "FileDownload",
          "ComponentName": "VisualStudio2015AdminDeployment"
        }
      ],
      "Validate": {
        "PathsExist": [
          "C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\Common7\\IDE\\devenv.exe"
        ]
      }
    },
    {
      "ComponentName": "MozillaBuildSetup",
      "ComponentType": "ExeInstall",
      "Comment": "Base Firefox on Windows build requirement",
      "Arguments": [
        "/S",
        "/D=C:\\mozilla-build"
      ],
      "Url": "http://ftp.mozilla.org/pub/mozilla/libraries/win32/MozillaBuildSetup-2.2.0.exe",
      "Validate": {
        "PathsExist": [
          "C:\\mozilla-build\\info-zip\\unzip.exe",
          "C:\\mozilla-build\\info-zip\\zip.exe",
          "C:\\mozilla-build\\msys\\bin\\sh.exe",
          "C:\\mozilla-build\\msys\\local\\bin\\make.exe",
          "C:\\mozilla-build\\msys\\local\\bin\\autoconf-2.13",
          "C:\\mozilla-build\\python\\python.exe",
          "C:\\mozilla-build\\python\\Scripts\\hg.exe",
          "C:\\mozilla-build\\upx391w\\upx.exe",
          "C:\\mozilla-build\\yasm\\yasm.exe"
        ],
        "FilesContain": [
          {
            "Path": "C:\\mozilla-build\\VERSION",
            "Match": "2.2.0"
          }
        ]
      }
    },
    {
      "ComponentName": "VCForPython",
      "ComponentType": "MsiInstall",
      "Comment": "Required by BuildBot VirtualEnv used by Mozharness (c:/mozilla-build/buildbotve)",
      "Url": "https://download.microsoft.com/download/7/9/6/796EF2E4-801B-4FC4-AB28-B59FBF6D907B/VCForPython27.msi",
      "Name": "Microsoft Visual C++ Compiler Package for Python 2.7",
      "ProductId": "692514A8-5484-45FC-B0AE-BE2DF7A75891"
    },
    {
      "ComponentName": "VCForPythonShared",
      "ComponentType": "DirectoryCopy",
      "Comment": "VCForPython installs to an inaccessible location, this copies it to an accessible location.",
      "Source": "C:\\Windows\\SysWOW64\\config\\systemprofile\\AppData\\Local\\Programs\\Common\\Microsoft\\Visual C++ for Python",
      "Target": "C:\\Program Files (x86)\\Visual C++ for Python"
    },
    {
      "ComponentName": "MercurialPythonPatch",
      "ComponentType": "SymbolicLink",
      "Comment": "Required by hg extensions",
      "DependsOn": [
        {
          "ComponentType": "ExeInstall",
          "ComponentName": "MozillaBuildSetup"
        }
      ],
      "Target": "C:\\mozilla-build\\python\\python27.dll",
      "Link": "C:\\mozilla-build\\python\\Scripts\\python27.dll"
    },
    {
      "ComponentName": "MercurialConfig",
      "ComponentType": "FileDownload",
      "Comment": "Required by CloneBundles (hg extension)",
      "DependsOn": [
        {
          "ComponentType": "ExeInstall",
          "ComponentName": "MozillaBuildSetup"
        }
      ],
      "Source": "https://raw.githubusercontent.com/MozRelOps/OpenCloudConfig/master/userdata/Configuration/Mercurial/mercurial.ini",
      "Target": "C:\\mozilla-build\\python\\Scripts\\mercurial.ini"
    },
    {
      "ComponentName": "pip-upgrade-pip",
      "ComponentType": "CommandRun",
      "DependsOn": [
        {
          "ComponentType": "ExeInstall",
          "ComponentName": "MozillaBuildSetup"
        }
      ],
      "Command": "C:\\mozilla-build\\python\\python.exe",
      "Arguments": [
        "-m",
        "pip",
        "install",
        "--upgrade",
        "pip==8.1.1"
      ],
      "Validate": {
        "CommandsReturn": [
          {
            "Command": "C:\\mozilla-build\\python\\python.exe",
            "Arguments": [
              "-m",
              "pip",
              "show",
              "pip"
            ],
            "Match": "Version: 8.1.1"
          }
        ]
      }
    },
    {
      "ComponentName": "pip-upgrade-setuptools",
      "ComponentType": "CommandRun",
      "DependsOn": [
        {
          "ComponentType": "CommandRun",
          "ComponentName": "pip-upgrade-pip"
        }
      ],
      "Command": "C:\\mozilla-build\\python\\python.exe",
      "Arguments": [
        "-m",
        "pip",
        "install",
        "--upgrade",
        "setuptools==20.7.0"
      ],
      "Validate": {
        "CommandsReturn": [
          {
            "Command": "C:\\mozilla-build\\python\\python.exe",
            "Arguments": [
              "-m",
              "pip",
              "show",
              "setuptools"
            ],
            "Match": "Version: 20.7.0"
          }
        ]
      }
    },
    {
      "ComponentName": "pip-upgrade-virtualenv",
      "ComponentType": "CommandRun",
      "DependsOn": [
        {
          "ComponentType": "CommandRun",
          "ComponentName": "pip-upgrade-pip"
        }
      ],
      "Command": "C:\\mozilla-build\\python\\python.exe",
      "Arguments": [
        "-m",
        "pip",
        "install",
        "--upgrade",
        "virtualenv==15.0.1"
      ],
      "Validate": {
        "CommandsReturn": [
          {
            "Command": "C:\\mozilla-build\\python\\python.exe",
            "Arguments": [
              "-m",
              "pip",
              "show",
              "virtualenv"
            ],
            "Match": "Version: 15.0.1"
          }
        ]
      }
    },
    {
      "ComponentName": "pip-upgrade-wheel",
      "ComponentType": "CommandRun",
      "DependsOn": [
        {
          "ComponentType": "CommandRun",
          "ComponentName": "pip-upgrade-pip"
        }
      ],
      "Command": "C:\\mozilla-build\\python\\python.exe",
      "Arguments": [
        "-m",
        "pip",
        "install",
        "--upgrade",
        "wheel==0.29.0"
      ],
      "Validate": {
        "CommandsReturn": [
          {
            "Command": "C:\\mozilla-build\\python\\python.exe",
            "Arguments": [
              "-m",
              "pip",
              "show",
              "wheel"
            ],
            "Match": "Version: 0.29.0"
          }
        ]
      }
    },
    {
      "ComponentName": "pip-upgrade-pypiwin32",
      "ComponentType": "CommandRun",
      "DependsOn": [
        {
          "ComponentType": "CommandRun",
          "ComponentName": "pip-upgrade-pip"
        }
      ],
      "Command": "C:\\mozilla-build\\python\\python.exe",
      "Arguments": [
        "-m",
        "pip",
        "install",
        "--upgrade",
        "pypiwin32==219"
      ],
      "Validate": {
        "CommandsReturn": [
          {
            "Command": "C:\\mozilla-build\\python\\python.exe",
            "Arguments": [
              "-m",
              "pip",
              "show",
              "pypiwin32"
            ],
            "Match": "Version: 219"
          }
        ]
      }
    },
    {
      "ComponentName": "pip-upgrade-requests",
      "ComponentType": "CommandRun",
      "DependsOn": [
        {
          "ComponentType": "CommandRun",
          "ComponentName": "pip-upgrade-pip"
        }
      ],
      "Command": "C:\\mozilla-build\\python\\python.exe",
      "Arguments": [
        "-m",
        "pip",
        "install",
        "--upgrade",
        "requests==2.9.1"
      ],
      "Validate": {
        "CommandsReturn": [
          {
            "Command": "C:\\mozilla-build\\python\\python.exe",
            "Arguments": [
              "-m",
              "pip",
              "show",
              "requests"
            ],
            "Match": "Version: 2.9.1"
          }
        ]
      }
    },
    {
      "ComponentName": "pip-upgrade-psutil",
      "ComponentType": "CommandRun",
      "DependsOn": [
        {
          "ComponentType": "CommandRun",
          "ComponentName": "pip-upgrade-pip"
        }
      ],
      "Command": "C:\\mozilla-build\\python\\python.exe",
      "Arguments": [
        "-m",
        "pip",
        "install",
        "--upgrade",
        "psutil==4.1.0"
      ],
      "Validate": {
        "CommandsReturn": [
          {
            "Command": "C:\\mozilla-build\\python\\python.exe",
            "Arguments": [
              "-m",
              "pip",
              "show",
              "psutil"
            ],
            "Match": "Version: 4.1.0"
          }
        ]
      }
    },
    {
      "ComponentName": "ToolToolInstall",
      "ComponentType": "FileDownload",
      "DependsOn": [
        {
          "ComponentType": "ExeInstall",
          "ComponentName": "MozillaBuildSetup"
        }
      ],
      "Source": "https://raw.githubusercontent.com/mozilla/build-tooltool/master/tooltool.py",
      "Target": "C:\\mozilla-build\\tooltool.py"
    },
    {
      "ComponentName": "BuildBotVirtualEnvCreate",
      "ComponentType": "CommandRun",
      "DependsOn": [
        {
          "ComponentType": "CommandRun",
          "ComponentName": "pip-upgrade-virtualenv"
        },
        {
          "ComponentType": "CommandRun",
          "ComponentName": "pip-upgrade-setuptools"
        },
        {
          "ComponentType": "CommandRun",
          "ComponentName": "pip-upgrade-wheel"
        }
      ],
      "Command": "C:\\mozilla-build\\python\\python.exe",
      "Arguments": [
        "-m",
        "virtualenv",
        "C:\\mozilla-build\\buildbotve"
      ],
      "Validate": {
        "PathsExist": [
          "C:\\mozilla-build\\buildbotve",
          "C:\\mozilla-build\\buildbotve\\Scripts"
        ]
      }
    },
    {
      "ComponentName": "BuildBotVirtualEnvDotPyInstall",
      "ComponentType": "FileDownload",
      "DependsOn": [
        {
          "ComponentType": "CommandRun",
          "ComponentName": "BuildBotVirtualEnvCreate"
        }
      ],
      "Source": "https://hg.mozilla.org/mozilla-central/raw-file/78babd21215d/python/virtualenv/virtualenv.py",
      "Target": "C:\\mozilla-build\\buildbotve\\virtualenv.py"
    },
    {
      "ComponentName": "BuildBotVirtualEnvSupportDirectory",
      "ComponentType": "DirectoryCreate",
      "Path": "C:\\mozilla-build\\buildbotve\\virtualenv_support",
      "DependsOn": [
        {
          "ComponentType": "CommandRun",
          "ComponentName": "BuildBotVirtualEnvCreate"
        },
        {
          "ComponentType": "FileDownload",
          "ComponentName": "BuildBotVirtualEnvDotPyInstall"
        }
      ]
    },
    {
      "ComponentName": "BuildBotVirtualEnvSupport-pip-8.1.1-py2.py3-none-any.whl",
      "ComponentType": "FileDownload",
      "DependsOn": [
        {
          "ComponentType": "DirectoryCreate",
          "ComponentName": "BuildBotVirtualEnvSupportDirectory"
        }
      ],
      "Source": "https://pypi.python.org/packages/py2.py3/p/pip/pip-8.1.1-py2.py3-none-any.whl#md5=22db7b6a517a09c29d54a76650f170eb",
      "Target": "C:\\mozilla-build\\buildbotve\\virtualenv_support\\pip-8.1.1-py2.py3-none-any.whl"
    },
    {
      "ComponentName": "BuildBotVirtualEnvSupport-setuptools-20.7.0-py2.py3-none-any.whl",
      "ComponentType": "FileDownload",
      "DependsOn": [
        {
          "ComponentType": "DirectoryCreate",
          "ComponentName": "BuildBotVirtualEnvSupportDirectory"
        }
      ],
      "Source": "https://pypi.python.org/packages/py2.py3/s/setuptools/setuptools-20.7.0-py2.py3-none-any.whl#md5=9e0248519bf3e19ca6b3c217dc633ba8",
      "Target": "C:\\mozilla-build\\buildbotve\\virtualenv_support\\setuptools-20.7.0-py2.py3-none-any.whl"
    },
    {
      "ComponentName": "BuildBotVirtualEnvSupport-virtualenv-15.0.1-py2.py3-none-any.whl",
      "ComponentType": "FileDownload",
      "DependsOn": [
        {
          "ComponentType": "DirectoryCreate",
          "ComponentName": "BuildBotVirtualEnvSupportDirectory"
        }
      ],
      "Source": "https://pypi.python.org/packages/py2.py3/v/virtualenv/virtualenv-15.0.1-py2.py3-none-any.whl#md5=1fca0d03249563ccc475d39cfe71491e",
      "Target": "C:\\mozilla-build\\buildbotve\\virtualenv_support\\virtualenv-15.0.1-py2.py3-none-any.whl"
    },
    {
      "ComponentName": "BuildBotVirtualEnvSupport-wheel-0.29.0-py2.py3-none-any.whl",
      "ComponentType": "FileDownload",
      "DependsOn": [
        {
          "ComponentType": "DirectoryCreate",
          "ComponentName": "BuildBotVirtualEnvSupportDirectory"
        }
      ],
      "Source": "https://pypi.python.org/packages/py2.py3/w/wheel/wheel-0.29.0-py2.py3-none-any.whl#md5=d7db45db5c131af262b8ffccde46a88a",
      "Target": "C:\\mozilla-build\\buildbotve\\virtualenv_support\\wheel-0.29.0-py2.py3-none-any.whl"
    },
    {
      "ComponentName": "BuildBotVirtualEnvSupport-pypiwin32-219-cp27-none-win_amd64.whl",
      "ComponentType": "FileDownload",
      "DependsOn": [
        {
          "ComponentType": "DirectoryCreate",
          "ComponentName": "BuildBotVirtualEnvSupportDirectory"
        }
      ],
      "Source": "https://pypi.python.org/packages/cp27/p/pypiwin32/pypiwin32-219-cp27-none-win_amd64.whl#md5=d7bafcf3cce72c3ce9fdd633a262c335",
      "Target": "C:\\mozilla-build\\buildbotve\\virtualenv_support\\pypiwin32-219-cp27-none-win_amd64.whl"
    },
    {
      "ComponentName": "BuildBotVirtualEnvSupport-pypiwin32-219-cp27-none-win32.whl",
      "ComponentType": "FileDownload",
      "DependsOn": [
        {
          "ComponentType": "DirectoryCreate",
          "ComponentName": "BuildBotVirtualEnvSupportDirectory"
        }
      ],
      "Source": "https://pypi.python.org/packages/cp27/p/pypiwin32/pypiwin32-219-cp27-none-win32.whl#md5=a8b0c1b608c1afeb18cd38d759ee5e29",
      "Target": "C:\\mozilla-build\\buildbotve\\virtualenv_support\\pypiwin32-219-cp27-none-win32.whl"
    },
    {
      "ComponentName": "BuildBotVirtualEnvSupport-requests-2.7.0-py2.py3-none-any.whl",
      "ComponentType": "FileDownload",
      "DependsOn": [
        {
          "ComponentType": "DirectoryCreate",
          "ComponentName": "BuildBotVirtualEnvSupportDirectory"
        }
      ],
      "Source": "https://pypi.python.org/packages/2.7/r/requests/requests-2.7.0-py2.py3-none-any.whl#md5=564fb256f865a79f977e57b79d31659a",
      "Target": "C:\\mozilla-build\\buildbotve\\virtualenv_support\\requests-2.7.0-py2.py3-none-any.whl"
    },
    {
      "ComponentName": "BuildBotVirtualEnvSupport-requests-2.8.1-py2.py3-none-any.whl",
      "ComponentType": "FileDownload",
      "DependsOn": [
        {
          "ComponentType": "DirectoryCreate",
          "ComponentName": "BuildBotVirtualEnvSupportDirectory"
        }
      ],
      "Source": "https://pypi.python.org/packages/2.7/r/requests/requests-2.8.1-py2.py3-none-any.whl#md5=46f1d621daa3ab38958a42f51478b1ee",
      "Target": "C:\\mozilla-build\\buildbotve\\virtualenv_support\\requests-2.8.1-py2.py3-none-any.whl"
    },
    {
      "ComponentName": "BuildBotVirtualEnvSupport-requests-2.9.1-py2.py3-none-any.whl",
      "ComponentType": "FileDownload",
      "DependsOn": [
        {
          "ComponentType": "DirectoryCreate",
          "ComponentName": "BuildBotVirtualEnvSupportDirectory"
        }
      ],
      "Source": "https://pypi.python.org/packages/2.7/r/requests/requests-2.9.1-py2.py3-none-any.whl#md5=58a444aaa02780ad01983f5f540e67b2",
      "Target": "C:\\mozilla-build\\buildbotve\\virtualenv_support\\requests-2.9.1-py2.py3-none-any.whl"
    },
    {
      "ComponentName": "BuildBotVirtualEnvSupport-psutil-4.1.0-cp27-cp27m-win_amd64.whl",
      "ComponentType": "FileDownload",
      "DependsOn": [
        {
          "ComponentType": "DirectoryCreate",
          "ComponentName": "BuildBotVirtualEnvSupportDirectory"
        }
      ],
      "Source": "https://pypi.python.org/packages/2.7/p/psutil/psutil-4.1.0-cp27-cp27m-win_amd64.whl#md5=ab1ce766f282ab4246fd00f78a6f72b4",
      "Target": "C:\\mozilla-build\\buildbotve\\virtualenv_support\\psutil-4.1.0-cp27-cp27m-win_amd64.whl"
    },
    {
      "ComponentName": "BuildBotVirtualEnvSupport-psutil-4.1.0-cp27-cp27m-win32.whl",
      "ComponentType": "FileDownload",
      "DependsOn": [
        {
          "ComponentType": "DirectoryCreate",
          "ComponentName": "BuildBotVirtualEnvSupportDirectory"
        }
      ],
      "Source": "https://pypi.python.org/packages/2.7/p/psutil/psutil-4.1.0-cp27-cp27m-win32.whl#md5=4bc43677c085c31f6cd288c4d52422ec",
      "Target": "C:\\mozilla-build\\buildbotve\\virtualenv_support\\psutil-4.1.0-cp27-cp27m-win32.whl"
    },
    {
      "ComponentName": "env-PATH",
      "ComponentType": "EnvironmentVariableUniquePrepend",
      "DependsOn": [
        {
          "ComponentType": "ExeInstall",
          "ComponentName": "MozillaBuildSetup"
        }
      ],
      "Name": "PATH",
      "Values": [
        "C:\\mozilla-build\\7zip",
        "C:\\mozilla-build\\msys\\bin",
        "C:\\mozilla-build\\msys\\local\\bin",
        "C:\\mozilla-build\\python",
        "C:\\mozilla-build\\python\\Scripts",
        "C:\\mozilla-build\\upx391w",
        "C:\\mozilla-build\\wget",
        "C:\\mozilla-build\\yasm",
        "C:\\mozilla-build\\info-zip"
      ],
      "Target": "Machine"
    },
    {
      "ComponentName": "env-HOSTTYPE",
      "ComponentType": "EnvironmentVariableSet",
      "Comment": "Just matching bb slave successful build environment. No idea if this does anything.",
      "Name": "HOSTTYPE",
      "Value": "i686",
      "Target": "Machine"
    },
    {
      "ComponentName": "env-INPUTRC",
      "ComponentType": "EnvironmentVariableSet",
      "Comment": "Just matching bb slave successful build environment. No idea if this does anything.",
      "Name": "INPUTRC",
      "Value": "C:\\mozilla-build\\msys\\etc\\inputrc",
      "Target": "Machine"
    },
    {
      "ComponentName": "env-OSTYPE",
      "ComponentType": "EnvironmentVariableSet",
      "Comment": "Just matching bb slave successful build environment. No idea if this does anything.",
      "Name": "OSTYPE",
      "Value": "msys",
      "Target": "Machine"
    },
    {
      "ComponentName": "env-MOZBUILDDIR",
      "ComponentType": "EnvironmentVariableSet",
      "DependsOn": [
        {
          "ComponentType": "ExeInstall",
          "ComponentName": "MozillaBuildSetup"
        }
      ],
      "Name": "MOZBUILDDIR",
      "Value": "C:\\mozilla-build",
      "Target": "Machine"
    },
    {
      "ComponentName": "env-MOZILLABUILD",
      "ComponentType": "EnvironmentVariableSet",
      "DependsOn": [
        {
          "ComponentType": "ExeInstall",
          "ComponentName": "MozillaBuildSetup"
        }
      ],
      "Name": "MOZILLABUILD",
      "Value": "C:\\mozilla-build",
      "Target": "Machine"
    },
    {
      "ComponentName": "env-MOZ_TOOLS",
      "ComponentType": "EnvironmentVariableSet",
      "DependsOn": [
        {
          "ComponentType": "ExeInstall",
          "ComponentName": "MozillaBuildSetup"
        }
      ],
      "Name": "MOZ_TOOLS",
      "Value": "C:\\mozilla-build\\moztools-x64",
      "Target": "Machine"
    },
    {
      "ComponentName": "env-VCINSTALLDIR",
      "ComponentType": "EnvironmentVariableSet",
      "DependsOn": [
        {
          "ComponentType": "MsiInstall",
          "ComponentName": "VCForPython"
        }
      ],
      "Name": "VCINSTALLDIR",
      "Value": "C:\\Windows\\SysWOW64\\config\\systemprofile\\AppData\\Local\\Programs\\Common\\Microsoft\\Visual C++ for Python\\9.0\\VC",
      "Target": "Machine"
    },
    {
      "ComponentName": "reg-WindowsErrorReportingLocalDumps",
      "ComponentType": "RegistryKeySet",
      "Comment": "",
      "Key": "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\Windows Error Reporting",
      "ValueName": "LocalDumps"
    },
    {
      "ComponentName": "reg-WindowsErrorReportingDontShowUI",
      "ComponentType": "RegistryValueSet",
      "Comment": "",
      "Key": "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\Windows Error Reporting",
      "ValueName": "DontShowUI",
      "ValueType": "Dword",
      "ValueData": "0x00000001",
      "Hex": true
    },
    {
      "ComponentName": "reg-useLegacyJit",
      "ComponentType": "RegistryValueSet",
      "Comment": "Disable JIT (bz1269809)",
      "Key": "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework",
      "ValueName": "useLegacyJit",
      "ValueType": "Dword",
      "ValueData": "0x00000001",
      "Hex": true
    },
    {
      "ComponentName": "reg-Wow6432Node-useLegacyJit",
      "ComponentType": "RegistryValueSet",
      "Comment": "Disable JIT (bz1269809)",
      "Key": "HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\.NETFramework",
      "ValueName": "useLegacyJit",
      "ValueType": "Dword",
      "ValueData": "0x00000001",
      "Hex": true
    },
    {
      "ComponentName": "env-DXSDK_DIR",
      "ComponentType": "EnvironmentVariableSet",
      "DependsOn": [
        {
          "ComponentType": "ExeInstall",
          "ComponentName": "DXSDK_Jun10"
        }
      ],
      "Name": "DXSDK_DIR",
      "Value": "C:\\Program Files (x86)\\Microsoft DirectX SDK (June 2010)",
      "Target": "Machine"
    },
    {
      "ComponentName": "GenericWorkerDirectory",
      "ComponentType": "DirectoryCreate",
      "Path": "C:\\generic-worker"
    },
    {
      "ComponentName": "GenericWorkerDownload",
      "ComponentType": "FileDownload",
      "DependsOn": [
        {
          "ComponentType": "DirectoryCreate",
          "ComponentName": "GenericWorkerDirectory"
        }
      ],
      "Source": "https://github.com/taskcluster/generic-worker/releases/download/v2.0.0alpha35/generic-worker-windows-amd64.exe",
      "Target": "C:\\generic-worker\\generic-worker.exe"
    },
    {
      "ComponentName": "LiveLogDownload",
      "ComponentType": "FileDownload",
      "DependsOn": [
        {
          "ComponentType": "DirectoryCreate",
          "ComponentName": "GenericWorkerDirectory"
        }
      ],
      "Source": "https://github.com/taskcluster/livelog/releases/download/v0.0.6/livelog-windows-amd64.exe",
      "Target": "C:\\generic-worker\\livelog.exe"
    },
    {
      "ComponentName": "LiveLog-Get",
      "ComponentType": "FirewallRule",
      "Protocol": "TCP",
      "LocalPort": 60022,
      "Direction": "Inbound",
      "Action": "Allow"
    },
    {
      "ComponentName": "LiveLog-Put",
      "ComponentType": "FirewallRule",
      "Protocol": "TCP",
      "LocalPort": 60023,
      "Direction": "Inbound",
      "Action": "Allow"
    },
    {
      "ComponentName": "GenericWorkerInstall",
      "ComponentType": "CommandRun",
      "Command": "C:\\generic-worker\\generic-worker.exe",
      "Arguments": [
        "install",
        "startup",
        "--config",
        "C:\\generic-worker\\generic-worker.config"
      ],
      "DependsOn": [
        {
          "ComponentType": "FileDownload",
          "ComponentName": "GenericWorkerDownload"
        },
        {
          "ComponentType": "FileDownload",
          "ComponentName": "LiveLogDownload"
        },
        {
          "ComponentType": "FirewallRule",
          "ComponentName": "LiveLog-Get"
        },
        {
          "ComponentType": "FirewallRule",
          "ComponentName": "LiveLog-Put"
        }
      ],
      "Validate": {
        "PathsExist": [
          "C:\\generic-worker\\run-generic-worker.bat",
          "C:\\generic-worker\\generic-worker.exe"
        ],
        "CommandsReturn": [
          {
            "Command": "C:\\generic-worker\\generic-worker.exe",
            "Arguments": [
              "--version"
            ],
            "Match": "generic-worker 2.0.0alpha33"
          }
        ]
      }
    },
    {
      "ComponentName": "GenericWorkerProfileAccessRights",
      "ComponentType": "CommandRun",
      "Comment": "Temporary hack until generic worker install homedir permissions are fixed. http://tinyurl.com/85nef5q",
      "Command": "icacls.exe",
      "Arguments": [
        "C:\\Users\\Default",
        "/grant",
        "Everyone:(OI)(CI)(M)",
        "/inheritance:r"
      ],
      "DependsOn": [
        {
          "ComponentType": "CommandRun",
          "ComponentName": "GenericWorkerInstall"
        }
      ]
    },
    {
      "ComponentName": "HgShared",
      "ComponentType": "DirectoryCreate",
      "Comment": "required by hg caches",
      "Path": "C:\\builds\\hg-shared"
    },
    {
      "ComponentName": "HgSharedAccessRights",
      "ComponentType": "CommandRun",
      "Comment": "allows builds to use `hg share ...`",
      "Command": "icacls.exe",
      "Arguments": [
        "C:\\builds\\hg-shared",
        "/grant",
        "Everyone:(OI)(CI)F",
        "/inheritance:r"
      ],
      "DependsOn": [
        {
          "ComponentType": "DirectoryCreate",
          "ComponentName": "HgShared"
        }
      ]
    },
    {
      "ComponentName": "MozillaCentralCacheCreate",
      "ComponentType": "CommandRun",
      "Comment": "required by firefox builds",
      "Command": "C:\\mozilla-build\\python\\Scripts\\hg.exe",
      "Arguments": [
        "clone",
        "-U",
        "https://hg.mozilla.org/mozilla-central",
        "C:\\builds\\hg-shared\\mozilla-central"
      ],
      "DependsOn": [
        {
          "ComponentType": "ExeInstall",
          "ComponentName": "MozillaBuildSetup"
        },
        {
          "ComponentType": "SymbolicLink",
          "ComponentName": "MercurialPythonPatch"
        },
        {
          "ComponentType": "DirectoryCreate",
          "ComponentName": "HgShared"
        }
      ],
      "Validate": {
        "PathsExist": [
          "C:\\builds\\hg-shared\\mozilla-central\\.hg"
        ]
      }
    },
    {
      "ComponentName": "MozillaCentralCacheUpdate",
      "ComponentType": "CommandRun",
      "Comment": "keeps the cache up to date on subsequent runs/reboots",
      "Command": "C:\\mozilla-build\\python\\Scripts\\hg.exe",
      "Arguments": [
        "pull",
        "-R",
        "C:\\builds\\hg-shared\\mozilla-central"
      ],
      "DependsOn": [
        {
          "ComponentType": "CommandRun",
          "ComponentName": "MozillaCentralCacheCreate"
        }
      ]
    },
    {
      "ComponentName": "BuildToolsCacheCreate",
      "ComponentType": "CommandRun",
      "Comment": "required by firefox builds",
      "Command": "C:\\mozilla-build\\python\\Scripts\\hg.exe",
      "Arguments": [
        "clone",
        "-U",
        "https://hg.mozilla.org/build/tools",
        "C:\\builds\\hg-shared\\build\\tools"
      ],
      "DependsOn": [
        {
          "ComponentType": "ExeInstall",
          "ComponentName": "MozillaBuildSetup"
        },
        {
          "ComponentType": "SymbolicLink",
          "ComponentName": "MercurialPythonPatch"
        },
        {
          "ComponentType": "DirectoryCreate",
          "ComponentName": "HgShared"
        }
      ],
      "Validate": {
        "PathsExist": [
          "C:\\builds\\hg-shared\\build\\tools\\.hg"
        ]
      }
    },
    {
      "ComponentName": "BuildToolsCacheUpdate",
      "ComponentType": "CommandRun",
      "Comment": "keeps the cache up to date on subsequent runs/reboots",
      "Command": "C:\\mozilla-build\\python\\Scripts\\hg.exe",
      "Arguments": [
        "pull",
        "-R",
        "C:\\builds\\hg-shared\\build\\tools"
      ],
      "DependsOn": [
        {
          "ComponentType": "CommandRun",
          "ComponentName": "BuildToolsCacheCreate"
        }
      ]
    },
    {
      "ComponentName": "BuildProps",
      "ComponentType": "FileDownload",
      "Source": "https://raw.githubusercontent.com/MozRelOps/OpenCloudConfig/master/userdata/Configuration/FirefoxBuildResources/buildprops.json",
      "Target": "C:\\builds\\buildprops.json"
    }
  ]
}
